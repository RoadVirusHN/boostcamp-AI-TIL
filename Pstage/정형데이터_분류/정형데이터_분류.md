# 정형 데이터 분류

> Naver AI Boostcamp의 정형 데이터 분류 강의를 정리한 내용입니다.

## 정형 데이터와 데이터의 이해

![정형 데이터](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412153448855.png)

*정형 데이터*란, 엑셀 파일이나 관계형 데이터베이스의 테이블에 담을 수 있는 데이터로 행(row)과 열(column)으로 표현 가능한 데이터. 하나의 행은 하나의 데이터 인스턴스를 나타내고, 각 열은 데이터의 피처를 나타냄

![MNIST](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412153510728.png)![도지](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412153550998.png)

*비정형 데이터*란 이미지, 비디오, 음성, 자연어 등의 정제되지 않은 데이터



정형 데이터는 범용적인 데이터이며, 가장 기본적이 데이터로 필수적이다.

정형 데이터의 분석을 위해서 문제를 이해해야 하며, 어떻게 문제를 풀지 고민해야 한다.

- 예를 들어 Input 데이터를 Aggregation 형태로 넣어주거나, TimeSeries로 넣어주거나, 양쪽 둘다 넣어주기
  - Aggregation: ex) 사람 하나당 하나의 row를 가지는 형식

- Train, Valid, Test 셋 나누기

- 적절한 평가지표를 선정해야 함.

분류(Classification) : 예측해야할 대상의 개수가 정해져 있는 문제 (ex) 신용카드 정상 거래 분류)

회귀(Regression) : 예측해야할 대상이 연속적인 숫자인 문제 (ex) 일기 예보 기온 예측)

평가지표(Evaluation Metric) : 분류, 회귀 머신러닝 문제의 성능을 평가할 지표

![Confusion matrix](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412161100848.png)

분류 문제의 평가지표를 알기 위해서 예측 경우를 정의한 Confusion Matrix에 대해서 알아야 한다.

TN : False를 False로 예측

FP : False를 True로 예측

FN: True를 False로 예측

TP: True를 True로 예측

분류 문제의 평가 지표들

1. Accuracy (정확도): (TP + TN)/(TP+TN+FP+FN)

- 전체 비율 중 올바르게 분류한 비율
- 불균형 데이터에는 비적합함.
  - 100명 환자 중 1명의 암환자를 찾는 데이터에서 전부 그냥 환자가 아니라고 해도 99%의 정확도를 가진다.

2. Precision(정밀도): TP / (TP + FP)

- 모델이 True로 예측한 값 중 실제 True인 경우의 비율
- Negetive 데이터가 중요한 경우 사용 
  - 스팸 메일 분류(일반 메일은 스팸 메일로 분류해서 삭제하면 큰일남)

3. Recall(재현율) : TP / (TP + FN)

- 실제 값이 True인 값 중 모델이 True라고 한 경우의 비율

- Positive 데이터가 중요한 경우 사용

  - 종양의 종류 판단 시, 양성 종양이냐 악성 종양이나 분류

  

*ROC(Receiver operating characteristics, 수신자 조작 특성)*

- TPR(True Positive Ratio)$=\frac{TP}{TP+FN}$을 Y축, FPR(False Positive Ratio)$=\frac{FP}{FP+TN}$을 X축으로 하여 모델의 임계값을 바꿔가면서 그린 곡선

![AUC 그림](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412162830894.png)

*AUC(Area Under Curve)*

ROC의 면적을 표시한 것, 0과 1사이의 값을 가짐, 

1일수록 성능이 좋음.

## EDA

EDA(Exploratory Data Analysis, 탐색적 데이터 분석)

데이터를 탐색하고 가설을 세우고 증명하는 과정, 주어진 문제를 데이터를 통해 해결하기 위해 필요하다.

때문에 적절한 전처리, 방법론들을 선택하고, 가설과 의문을 세운뒤 검증, 입증하여 해결한다.

EDA의 과정

1. Data에 대한 가설 혹은 의문
2. 시각화 혹은 통계량, 모델링을 통한 가설 검정
3. 위의 결론을 통해 다시 새로운 가설 혹은 문제 해결

데이터 종류, 도메인, 사용 모델 등에 따라 EDA의 방향성과 방법이 달라지며, 정해진 답이 존재하지 않음

때문에 EDA 과정에서 수많은 활동과 과정을 거쳐야 하며, 이를 방향성 없이 풀어나가는 것은 비효율적이므로, 다음 두가지를 기본 개요로 놓고 시작한다.

1. 개발 변수의 분포(Variation)

2. 변수 간의 분포와 관계(Covariation)

**Titanic data를 이용한 EDA의 예시**

이름, 성별, 나이, 좌석 등을 이용해 생존 여부를 판단하는 Task

![Titanic data 데이터 파악 예시](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412224019875.png)

![연속형 변수의 예시](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412224138196.png)

Age, SibSp, Parch, Fare 등은 연속형 변수이며, Age의 경우 포아송 분포를 따르고 있다.

![범주형 변수의 예시](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412224158525.png)

Pclass, sex, Embarked 등은 각 값이 구분 이외에는 의미가 없는 범주형이며,  상식적으로 female과 male은 동일해야하고, Pclass의 경우 높은 등급이 더적어야 하므로, 데이터 불균형이나 특별한 상황을 가정할 수 있다.

![변수간의 관계 예시 성별 vs 생존여부](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412230934381.png)

변수 간 그래프를 통해 변수의 관계를 알 수 있다. 위의 경우 당시 타이타닉에서 여성이 남성보다 생존하도록 배려를 받았음을 알 수 있다.

![결혼 여부에 따른 생존 여부](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412231059081.png)

기존 변수에서 다른 변수를 추출해서 변수간의 관계를 비교할 수 도 있다.

위의 경우 이름에서 결혼 여부를 추출하여 생존여부를 따져 보자 미혼 여성이 생존자가 많다는 것을 알 수 있다.

![결혼 여부에 따른 생존율](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412231220023.png)

하지만 생존비율은 결혼한 여성이 더욱 많이 살아남았다.

![솔로 여부에 따른 생존율](C:\Users\roadv\Desktop\AI_boostcamp\BoostCamp AI TIL\Pstage\정형데이터_분류\정형데이터_분류.assets\image-20210412231634713.png)

또한 기존의 변수 여러개를 이용해 새로운 변수 또한 만들 수 있다.

혼자 탑승한 사람은 생존율이 좀더 낮다.